#!/data/data/com.termux/files/usr/bin/bash
# file is ran when url is shared with TEL
source tel-helpers
width=$(term_width)
log "recieved url: \n ${1:0:$WIDTH}"
PS3="Select a numbered option: "
select choice in "Open in $BROWSER" "Video Download" "URL Download"
do
	case $REPLY in
		1)
			echo -n 'opening in $BROWSER'
			links $1 || w3m $1
			break
			;;
		2)
			echo -n 'downloading video to ~/storage/downloads/'
			youtube-dl -f 'bestvideo[ext=mp4][height<=720]+bestaudio' --restrict-filenames -o '~/storage/downloads/%(title)s-%(id)s.%(ext)s' $1
			break
			;;
		3)
			echo -n 'Enter a name for file: '
			read -p "Enter a name for the saved file: " filename 
			curl $1 > $filename > /dev/null 2>&1
			break
			;;
		4)
			echo -n 'Exiting..'
			exit 0
		*)
			echo -n 'not an option'
			;;
	esac
		
done

